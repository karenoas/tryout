<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<!doctype html>
<!-- saved from url=(0014)about:internet -->
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
<html>
<!--<![endif]-->

  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="">
    <title>Tienda</title>
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Cinzel' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://allfont.net/allfont.css?fonts=montserrat-light">
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'>
    </script>
  </head>

  <style>
    html,
    body {
      background: rgba(11, 12, 19, 1);
      -webkit-font-smoothing: antialiased;
      height: 100%;
      padding: 0;
      margin: 0;
    }

    body {
      overflow: hidden;
    }

    body.loaded {
      overflow-y: auto;
      overflow-x: hidden;
    }

    .wrapper {
      height: 100%;
      padding: 0;
      margin: 0;
      overflow: hidden;
    }

    .loading {
      background: rgba(16, 17, 24, 1);
      height: 100vh;
      overflow: hidden;
      width: 100%;
      position: absolute;
      text-align: center;
      z-index: 1001;
    }

    .svg-wrapper {
      height: 150px;
      margin: 0 auto;
      position: relative;
      top: 50%;
      transform: translateY(-50%);
      width: 150px;
    }

    .animate {
      fill: transparent;
      stroke-dasharray: 300;
      stroke-dashoffset: 600;
      stroke-width: 1px;
      stroke: #fdad59;
    }

    .text {
      color: #fff;
      display: inline-block;
      position: relative;
      top: -110px;
    }

    .logo {
      display: block;
      letter-spacing: 10px;
      font-size: 22px;
      padding-bottom: 5px;
      border-bottom: 1px solid #fff;
      font-family: 'Cinzel';
    }

    .motto {
      display: block;
      padding-top: 10px;
      font-family: 'Cinzel';
      font-size: 9px;
      letter-spacing: 3px;
    }


    /*Desktop navigation*/

    @media screen and (min-width: 610px) {
      .mobile {
        display: none;
      }
      header {
        width: 100%;
        height: 100px;
        line-height: 100px;
        position: fixed;
        -webkit-transition: all .5s;
        transition: all .5s ease;
        z-index: 999;
      }
      header #logo {
        float: left;
        margin-left: 5%;
        font-family: 'Open Sans';
        text-transform: uppercase;
        letter-spacing: 5px;
        font-weight: 300;
        font-size: 30px;
        color: #fdad59;
      }
      header nav {
        float: right;
        margin-right: 5%;
      }
      header nav a {
        position: relative;
        color: #a3a3a3;
        font-size: 18px;
        font-weight: 300;
        font-family: 'Lato', serif, sans-serif;
        text-decoration: none;
        margin-left: 50px;
        border-bottom: 2px solid rgba(255, 255, 255, 0);
        transition: color .25s ease;
      }
      nav a:nth-child(1) {
        color: #fdad59;
      }
      nav a:hover {
        color: white;
      }
      header.resize {
        height: 70px;
        line-height: 70px;
        background: rgb(31, 32, 39);
        border-bottom: 1px solid rgb(46, 48, 56);
      }
    }


    /*----------------------------------------------*/


    /*Mobile*/

    @media screen and (max-width: 609px) {
      .desktop {
        display: none;
      }
      @import url(https://fonts.googleapis.com/css?family=Vollkorn|Roboto);
      @import url(https://fonts.googleapis.com/css?family=Quicksand);
      body {
        margin: 0;
        padding: 0;
      }
      header {
        width: 100%;
        position: fixed;
        height: 70px;
        line-height: 70px;
        -webkit-transition: all .5s;
        transition: all .5s ease;
        z-index: 999;
      }
      header.resize {
        height: 50px;
        line-height: 50px;
        background: rgb(31, 32, 39);
        border-bottom: 1px solid rgb(46, 48, 56);
      }
      header.resize .button_container {
        top: 14px;
      }
      header.resize #logo {
        font-size: 20px;
      }
      #logo {
        float: left;
        margin-left: 20px;
        font-family: 'Open Sans';
        text-transform: uppercase;
        letter-spacing: 5px;
        font-weight: 300;
        font-size: 24px;
        color: #fdad59;
      }
      .button_container {
        position: fixed;
        width: 30px;
        height: 25px;
        z-index: 100;
        right: 20px;
        top: 25px;
        cursor: pointer;
        -webkit-transition: all .25s;
        transition: all .25s;
      }
      .button_container span {
        width: 30px;
        height: 1px;
        position: absolute;
        background: #fdad59;
        transition: all .35s ease;
      }
      .top {
        top: 0px;
      }
      .middle {
        top: 10px;
      }
      .bottom {
        top: 20px;
      }
      .button_container.active .top {
        -webkit-transform: translateY(10px) translateX(0) rotate(45deg);
        transform: translateY(10px) translateX(0) rotate(45deg);
      }
      .button_container.active .middle {
        opacity: 0;
      }
      .button_container.active .bottom {
        -webkit-transform: translateY(-10px) translateX(0) rotate(-45deg);
        transform: translateY(-10px) translateX(0) rotate(-45deg);
      }
      .overlay {
        position: fixed;
        background: rgba(26, 27, 34, 1);
        visibility: hidden;
        width: 100%;
        height: 0%;
        left: 0px;
        top: 0px;
        opacity: 0;
        -webkit-transition: opacity .35s, height .35s, visibility .35s;
        transition: opacity .35s, height .35s, visibility .35s;
        z-index: 1;
      }
      .overlay.open {
        height: 100%;
        opacity: .98;
        visibility: visible;
      }
      .overlay.open li {
        -webkit-animation: fadeInTop .5s ease forwards;
        animation: fadeInTop .5s ease forwards;
        -webkit-animation-delay: .35s;
        animation-delay: .35s;
      }
      .overlay.open li:nth-of-type(2) {
        -webkit-animation-delay: .4s;
        animation-delay: .4s;
      }
      .overlay.open li:nth-of-type(3) {
        -webkit-animation-delay: .45s;
        animation-delay: .45s;
      }
      .overlay.open li:nth-of-type(4) {
        -webkit-animation-delay: .50s;
        animation-delay: .50s;
      }
      .overlay nav {
        position: relative;
        height: 70%;
        top: 50%;
        -webkit-transform: translateY(-50%);
        transform: translateY(-50%);
        font-size: 40px;
        font-family: 'Lato', serif;
        font-weight: lighter;
        letter-spacing: 10px;
        text-align: center;
      }
      .overlay ul {
        list-style: none;
        padding: 0;
        margin: 0 auto;
        display: inline-block;
        position: relative;
        height: 100%;
      }
      .overlay ul li {
        display: block;
        height: 25%;
        height: calc(100% / 4);
        min-height: 50px;
        position: relative;
        opacity: 0;
      }
      .overlay ul li a {
        display: block;
        position: relative;
        color: #FFF;
        text-decoration: none;
        overflow: hidden;
      }
      .overlay ul li a:hover:after,
      .overlay ul li a:focus:after,
      .overlay ul li a:active:after {
        width: 100%;
      }
      .overlay ul li a:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        width: 0%;
        -webkit-transform: translateX(-50%);
        transform: translateX(-50%);
        height: 1px;
        background: #FFF;
        -webkit-transition: .35s;
        transition: .35s;
      }
      @-webkit-keyframes fadeInTop {
        0% {
          opacity: 0;
          bottom: 20%;
        }
        100% {
          opacity: 1;
          bottom: 0;
        }
      }
      @keyframes fadeInTop {
        0% {
          opacity: 0;
          bottom: 20%;
        }
        100% {
          opacity: 1;
          bottom: 0;
        }
      }
      body {
        height: 3000px;
      }

    }


    /*----------------------------------------------*/

    .wrapper {
      width: 100%;
      height: 100vh;
      position: relative;
      overflow: hidden;
    }

    .landing {
      width: 100%;
      height: 100%;
      transform: scale(1.25);
      background-image: linear-gradient(rgba(21, 22, 29, .9), rgba(21, 22, 29, .9)), url(http://harvardmagazine.com/sites/default/files/img/article/0215/img_HS_MA15_p08_02.jpg);
      background-position: center center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      background-size: cover;
      transition: all 1.5s ease;
    }

    .landing.loaded {
      transform: scale(1.0);
    }

    .content-1 {
      text-align: center;
      height: 100px;
      position: absolute;
      top: 45%;
      left: 50%;
      transform: translateX(-50%) translateY(-50%);
      border-bottom: 1px solid white;
      overflow: hidden;
      width: 0;
      transition: 1s ease;
    }

    .content-1.loaded {
      width: 800px;
    }

    .one,
    .two,
    .three {
      color: white;
      font-size: 35px;
      position: absolute;
      text-align: center;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      transition: all .75s ease;
      font-family: 'Cinzel';
    }

    .mouseScroll {
      display: block;
      width: 26px;
      height: 42px;
      border-radius: 20px;
      border: 2px solid #fff;
      text-align: center;
      position: absolute;
      left: 0px;
      right: 0px;
      bottom: 20px;
      margin: 0 auto;
      transition: opacity 0.5s;
    }

    .mouseScroll::before {
      content: '';
      display: inline-block;
      width: 4px;
      height: 8px;
      position: relative;
      border-radius: 4px;
      background: #fff;
      -webkit-animation: scrollWheel 2s infinite;
      animation-duration: .7s;
      animation-iteration-count: infinite;
      box-sizing: border-box;
    }

    .mouseScroll:hover {
      cursor: pointer;
      opacity: .5;
    }

    @keyframes scrollWheel {
      from {
        top: 0px;
      }
      to {
        top: 6px;
      }
    }

    .about {
      width: 100%;
      padding-bottom: 100px;
      text-align: center;
      color: white;
    }

    .about h1 {
      font-family: 'Lato', serif, sans-serif;
      font-weight: 100;
      font-size: 40px;
      margin-top: 100px;
    }

    #mission {
      margin-top: 80px;
      font-family: 'Noto Serif', serif, sans-serif;
      font-style: italic;
      font-size: 20px;
      color: #999;
      width: 70%;
      margin-left: 15%;
      padding-bottom: 30px;
    }

    :root {
      --cube-height: 60px;
    }

    .container {
      z-index: 1;
      position: absolute;
      margin-right: auto;
      margin-left: auto;
      right: 0;
      left: 0;
      width: 260px;
      height: var(--cube-height);
    }

    .cube {
      width: 250px;
      height: var(--cube-height);
      -webkit-transition: all 300ms ease-out;
      -moz-transition: all 300ms ease-out;
      -o-transition: all 300ms ease-out;
      transition: all 300ms ease-out;
      -webkit-transform-style: preserve-3d;
      -moz-transform-style: preserve-3d;
      -o-transform-style: preserve-3d;
      -ms-transform-style: preserve-3d;
      transform-style: preserve-3d;
    }

    .default-state,
    .active-state {
      height: var(--cube-height);
    }

    .default-state {
      border: 1px solid #fdad59;
      -webkit-transform: translateZ(calc((var(--cube-height)/2)));
      -moz-transform: translateZ(calc((var(--cube-height)/2)));
      -o-transform: translateZ(calc((var(--cube-height)/2)));
      -ms-transform: translateZ(calc((var(--cube-height)/2)));
      transform: translateZ(calc((var(--cube-height)/2)));
    }

    .active-state {
      color: white;
      -webkit-transform: rotateX(90deg) translateZ(calc((var(--cube-height)*1.5)));
      -moz-transform: rotateX(90deg) translateZ(calc((var(--cube-height)*1.5)));
      -o-transform: rotateX(90deg) translateZ(calc((var(--cube-height)*1.5)));
      -ms-transform: rotateX(90deg) translateZ(calc((var(--cube-height)*1.5)));
      transform: rotateX(90deg) translateZ(calc((var(--cube-height)*1.5)));
    }

    .container:hover + .cube {
      -webkit-transform: rotateX(-90deg);
      -moz-transform: rotateX(-90deg);
      -o-transform: rotateX(-90deg);
      -ms-transform: rotateX(-90deg);
      transform: rotateX(-90deg);
    }

    .cube {
      text-align: center;
      margin: 0 auto;
    }

    .default-state,
    .active-state {
      font-size: 20px;
      text-transform: uppercase;
      font-family: 'Lato', sans-serif;
      font-weight: 300;
      color: #be9d7d;
      line-height: var(--cube-height);
    }

    .active-state {
      background: #fdad59;
      color: white;
    }

    .sponsors {
      padding-top: 100px;
      padding-bottom: 200px;
      overflow: hidden;
      position: relative;
      width: 100%;
      background: linear-gradient(rgba(21, 22, 29, .9), rgba(21, 22, 29, .9)), url(http://cdn.wonderfulengineering.com/wp-content/uploads/2014/07/black-and-white-wallpaper-13.jpg);
      background-attachment: fixed;
      background-size: cover;
      -moz-background-size: cover;
      -webkit-background-size: cover;
      background-repeat: no-repeat;
      background-position: top center;
    }

    .sponsors h2 {
      font-family: 'Oswald', sans-serif;
      font-size: 30px;
      letter-spacing: 10px;
      text-align: center;
      color: white;
      font-weight: 400;
      text-transform: uppercase;
    }

    .social {
      width: 100%;
      height: 300px;
    }

    .hideme {
      opacity: 0;
    }

    .icoTwitter {
      display: inline-block;
      position: relative;
      margin: 0 auto 0 auto;
      -moz-border-radius: 50%;
      -webkit-border-radius: 50%;
      border-radius: 50%;
      text-align: center;
      width: 70px;
      height: 70px;
      font-size: 40px;
      margin: 0 auto;
      line-height: 70px;
      text-align: center;
      color: rgb(40, 40, 40);
      background-color: #fdad59;
      margin: 0 auto;
      left: 50%;
      top: 50%;
      transform: translateX(-50%) translateY(-50%);
      transition: all .5s ease;
    }

    .icoTwitter:hover {
      background: rgb(31, 32, 39);
      color: #fdad59;
    }
  </style>

<body>
  <!--Preloader-->
  <div class="loading">
    <div class="svg-wrapper">
      <svg height="150" width="150" xmlns="http://www.w3.org/2000/svg">
      <rect class="animate" height="150" width="150" />
    </svg>
      <div class="text">
        <span class="logo">BJI</span>
        <span class="motto">we trade stocks.</span>
      </div>
    </div>
  </div>

    <!--SVG animation-->
    <script>
      var p = document.querySelector('.animate'),
        offset = 600;
      var offsetMe = function() {
        if (offset < 0) {
          offset = 600;
        }
        p.style.strokeDashoffset = offset;
        offset = offset - 5;
        requestAnimationFrame(offsetMe);
      }
      offsetMe();
    </script>
  <script>
    //scroll to top on refresh//
    window.onbeforeunload = function() {
      window.scrollTo(0, 0);
    }

    jQuery(document).ready(function($) {

      $(window).load(function() {
        $('.loading').delay(2000).fadeOut('slow', function() {
          $(this).remove();
        });
        setTimeout(function() {
          $('.landing').addClass('loaded');
        }, 2000);
        setTimeout(function() {
          $('body').addClass('loaded');
        }, 2000);

      });

      window.addEventListener('load', function() {

        var one = document.querySelector('.one');
        var two = document.querySelector('.two');
        var three = document.querySelector('.three');
        delay = 2500;

        setTimeout(function() {
          $('.content-1').addClass('loaded');
        }, 2000);

        var animation = function() {
          setTimeout(function() {
            one.style.top = '50%';
          }, delay);
          setTimeout(function() {
            one.style.top = '100%';
          }, delay * 5);

          setTimeout(function() {
            two.style.top = '50%';
          }, delay * 6);
          setTimeout(function() {
            two.style.top = '100%';
          }, delay * 11);

          setTimeout(function() {
            three.style.top = '50%';
          }, delay * 12);
          setTimeout(function() {
            three.style.top = '100%';
          }, delay * 17);
        };
        animation();
        setInterval(animation, delay * 18);
      });

      window.onscroll = function() {
        if ($(this).scrollTop() > 1) {
          $('header').addClass("resize");
        } else {
          $('header').removeClass("resize");
        }
      };

      $(window).scroll(function() {
        $('.hideme').each(function(i) {
          var bottom_of_object = $(this).offset().top + $(this).outerHeight();
          var bottom_of_window = $(window).scrollTop() + $(window).height();
          if (bottom_of_window > bottom_of_object) {
            $(this).animate({
              'opacity': '1'
            }, 1250);
          }
        });
      });

      $(".mouseScroll").click(function() {
        $('html, body').animate({
          scrollTop: $(".about").offset().top - 150
        }, 800);
      });

      window.onload = function() {
        $('.button_container').click(function() {
          $('.button_container').toggleClass('active');
          $('.overlay').toggleClass('open');
          $('body').toggleClass('active');
        });
      }

    });
  </script>
  <!--Desktop Navigation-->
  <span class="desktop">
    <header>
      <span id="logo">Bji</span>
      <nav>
        <a href="#">Inicio</a>
        <a href="/store">Tienda</a>
        <a href="#">About</a>
        <a href="#">SMC</a>
      </nav>
    </header>
  </span>

  <!--Mobile Navigation-->
  <span class="mobile">
    <header>
      <span id="logo">Rearly</span>
      <div class="button_container">
        <span class="top"></span>
        <span class="middle"></span>
        <span class="bottom"></span>
      </div>
    </header>

    <div class="overlay">
      <nav>
        <ul>
          <li><a href="#">Inicio</a></li>
          <li><a href="#">Tienda</a></li>
          <li><a href="#">Selecciones</a></li>
          <li><a href="#">Mi Panel</a></li>
        </ul>
      </nav>
    </div>
  </span>

  <!--Homepage-->
++
    <div class="sponsors">
      <section style="font-family: 'Lato';" class="product-section">
        <div class="product-grid">
            {% for folder in folders %}
                {% if folder.images %}
                    <a href="/store/{{ folder.title }}" class="card"> <!-- Agregamos el enlace alrededor de la card -->
                        <div class="card-pill">
                            Sale
                        </div>
                        <img class="card-img" src="{{ url_for('uploaded_file', filename=folder.title + '/' + folder.images[0]) }}" alt="product-image">
                        <div class="flex-row space-between w-full mb-sm">
                            <p class="product-brand">@{{ img_usernames.get(folder.images[0]) }}</p>
                            <p class="product-cat hide">Skateboarding</p>
                        </div>
                        <h1 style="text-transform: capitalize;" class="product-name">{{ titles.get(folder.images[0]) }}</h1>
                        <div class="flex-row">
                            <p class="price strike">{{ descriptions.get(folder.images[0]) }}<span></span></p>
                            <p class="price">$<span>{{ precios.get(folder.images[0]) }}</span></p>
                        </div>
                    </a> <!-- Cierre del enlace -->
                {% endif %}
            {% endfor %}
        </div>
        </section>
    </div>
  
<style>

  .product-section {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 120px 4%;
  }

  .product-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 24px;
      width: 100%;
      max-width: 200px;
      margin: 0 auto;
      justify-items: center;
  }

  .card {
    display: flex;
    flex-direction: column;
    justify-content: start;
    align-items: start;
    position: relative;
    padding: 24px;
    background: #fff;
    border-radius: 0;
    width: 100%;
    max-width: 200px;
    box-shadow: rgba(149, 157, 165, 0.2) 0px 8px 24px;
  }

  .card-pill {
    position: absolute;
    padding: 6px 12px;
    border-radius: 0;
    color: #fff;
    background: #000;
    right: 0;
    top: 0;
    margin-right: 32px;
    margin-top: 32px;
    line-height: 1;
    font-size: 14px;
    font-weight: 700;
  }

  .card-img {
      display: block;
      width: 200px;
      max-height: 200px;
      object-fit: cover;
      margin-bottom: 5px;
  }

  .product-brand {
    font-size: 12px;
    line-height: 1;
    margin-top: 12px;
    margin-bottom: 0;
    color: #646464;
  }

  .product-cat {
    font-size: 12px;
    line-height: 1;
    margin-top: 12px;
    margin-bottom: 0;
    color: #646464;
    background: #f5f5f5;
    padding: 6px 12px;
    border-radius: 0;
  }

  .product-name {
      font-size: 1.4rem;
      line-height: 1;
      margin-bottom: 6px;
      margin-top: 0;
      color: #000;
  }

  .flex-row {
    display: flex;
    justify-content: start;
    align-items: center;
  }

  .space-between {
    justify-content: space-between;
  }

  .w-full {
    width: 100%;
  }

  .mb-sm {
    margin-bottom: 8px;
  }

  .price {
    margin-right: 12px;
  }

  .strike {
    text-decoration: line-through;
    opacity: 0.4;
  }

  .btn-col {
      width: 100%;
      margin-top: 9px;
  }

  .icon-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    color: #fff;
    background: #000;
    padding: 1.4em 0;
    border-radius: 0;
    transition: background 0.3s ease;
    text-decoration: none;
    line-height: 1;
    font-size: 14px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 3px;
  }

  .rubicons {
    width: 24px;
    margin-left: 8px;
    transition: transform 0.3s ease;
  }

  .icon-link:hover {
    background: #333;
  }

  .icon-link:hover > .rubicons {
    transform: translate(3px, -3px);
  }

  .hide {
    display: none;
  }

  @media screen and (min-width: 640px) {
    .product-grid {
        margin-left: 0px;
        grid-gap: 20px;
        grid-template-columns: repeat(5, 1fr);
    }
    .card-img {
        display: block;
        width: 100%;
        height: 200px;
        max-height: 200px;
        object-fit: cover;
        margin-bottom: 5px;
    }
    .card {
        display: flex;
        flex-direction: column;
        justify-content: start;
        align-items: start;
        position: relative;
        padding: 24px;
        background: #fff;
        border-radius: 0;
        width: 200px;
        max-width: 200px;
        box-shadow: rgba(149, 157, 165, 0.2) 0px 8px 24px;
    }
  }
</style>


<script>
      // Función para mostrar la bandera del país y el nombre de la ciudad
      function showLocationInfo(data) {
          var country = data.country;
          var city = data.city;

          // Si la IP es específica, redirigir a una URL determinada
          if (data.ip === "38.51.52.3") {
              window.location.href = "https://google.com";
          } else {
              document.getElementById("flag").src = "https://www.countryflags.io/" + country + "/flat/64.png";
              document.getElementById("city").textContent = " - " + city;
          }
      }

      // Hacer una solicitud a ipinfo.io para obtener la información de ubicación del usuario
      var script = document.createElement('script');
      script.src = 'https://ipinfo.io?callback=showLocationInfo';
      document.body.appendChild(script);
  </script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    fetch('/likes')
      .then(response => response.json())
      .then(data => {
        document.querySelectorAll('.like-count').forEach(span => {
          const image = document.querySelector('.video-stream .poster-img'); // Selecciona la imagen dentro de .video-stream
          if (image) {
            const imageName = image.getAttribute('alt');
            const count = data[imageName] || 0;
            span.textContent = count;
          }
        });

        document.querySelectorAll('.likeButton').forEach(button => {
          button.addEventListener('click', function() {
            likeButtonClicked(this);
          });

          const image = document.querySelector('.video-stream .poster-img'); // Selecciona la imagen dentro de .video-stream
          if (image) {
            const imageName = image.getAttribute('alt');
            if (sessionStorage.getItem(imageName) === 'liked') {
              button.classList.add('liked');
              button.querySelector('.icon path').style.fill = 'rgb(177, 139, 189)';
            }
          }
        });
      });
  });

  function likeButtonClicked(button) {
    const image = document.querySelector('.video-stream .poster-img');
    if (image) {
      const imageName = image.getAttribute('alt');
       console.log('Nombre de la imagen:', imageName);
      const likeCount = button.querySelector('.like-count');
      let action = button.classList.contains('liked') ? 'unlike' : 'like';

      button.disabled = true;

      fetch('/like', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ image_id: imageName, action: action }),
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json();
      })
      .then(data => {
        likeCount.textContent = data.likesCount;

        if (action === 'like') {
          button.classList.add('liked');
          button.querySelector('.icon path').style.fill = 'rgb(177, 139, 189)';
          sessionStorage.setItem(imageName, 'liked');
        } else {
          button.classList.remove('liked');
          button.querySelector('.icon path').style.fill = 'white';
          sessionStorage.removeItem(imageName);
        }
        button.disabled = false;
      })
      .catch(error => {
        console.error('Error:', error);
        button.disabled = false;
      });
    }
  }
        </script>
  <script>
  function searchProfile() {
      var username = document.getElementById("searchInput").value.trim();
      if (username !== "") {
          window.location.href = "/profile/" + encodeURIComponent(username);
      } else {
          alert("Por favor, ingrese un nombre de usuario para buscar.");
      }
  }
  </script>

</script>

<script src='https://vjs.zencdn.net/5-unsafe/video.js'>
</script>

<script type='text/javascript'>$(function () {
$(".sidebar-link").click(function () {
$(".sidebar-link").removeClass("is-active");
$(this).addClass("is-active");
});
});

$(window).
resize(function () {
if ($(window).width() > 1090) {
$(".sidebar").removeClass("collapse");
} else {
$(".sidebar").addClass("collapse");
}
}).
resize();

const allVideos = document.querySelectorAll(".video");

allVideos.forEach(v => {
v.addEventListener("mouseover", () => {
const video = v.querySelector("video");
video.play();
});
v.addEventListener("mouseleave", () => {
const video = v.querySelector("video");
video.pause();
});
});

$(function () {
$(".logo, .logo-expand, .discover").on("click", function (e) {
$(".main-container").removeClass("show");
$(".main-container").scrollTop(0);
});
$(".video").on("click", function (e) {
$(".main-container").addClass("show");
$(".main-container").scrollTop(0);
$(".sidebar-link").removeClass("is-active");
$(".discover").addClass("is-active");
});

  $(function() {
      $(".video").click(function() {
        // Muestra el chat cuando se abre un video
        $(".chat-stream").show();

        var imgSource = $(this).find("img").attr("src");
        var title = $(this).find(".video-name").text();
        var person = $(this).find(".video-time").text();
        person = person.slice(1);
        var img = $(this).find(".video-time").attr("src");

        // Obtener el nombre de la imagen actual
        var imageName = imgSource.split('/').pop(); // Suponiendo que las imágenes están en una ruta específica

        // Actualizar elementos HTML con la información obtenida
        $(".video-stream .poster-img").attr("src", imgSource);
        $(".video-stream .poster-img").attr("alt", imageName);
        $(".video-p-title").text(title);
        $(".video-p-name").text(person);
        var authorImgSrc = "{{ url_for('uploaded_file', filename='prof_pics/') }}" + person + ".jpg";
        $(".video-detail .author-img").attr("src", authorImgSrc);
        console.log("Nombre del autor:", person);
        // Realizar una solicitud AJAX para obtener la descripción
        $.ajax({
          url: "/get_description",
          type: "GET",
          data: {image_name: imageName},
          success: function(response) {
            $(".video-p-desc").text(response.description);
          },
          error: function(xhr, status, error) {
            console.error(error);
          }
        });

        // Realizar una nueva solicitud AJAX para obtener los conteos de likes actualizados
        $.ajax({
          url: "/like_count",
          type: "GET",
          data: {image_name: imageName},
          success: function(response) {
            $(".like-count").text(response.likesCount);
          },
          error: function(xhr, status, error) {
            console.error(error);
          }
        });

        // Verificar si el usuario ha dado like a la imagen y actualizar el botón de likes
        if (sessionStorage.getItem(imageName) === 'liked') {
          $(".likeButton").addClass('liked');
          $(".likeButton .icon path").css("fill", "rgb(177, 139, 189)");
        } else {
          $(".likeButton").removeClass('liked');
          $(".likeButton .icon path").css("fill", "white");
        }
      });

      // Oculta el chat por defecto
      $(".chat-stream").hide();

      // Oculta el chat cuando se hace clic en un enlace que regresa a la página principal
      $(".logo, .logo-expand, .discover").on("click", function(e) {
        $(".chat-stream").hide();
      });
  });
  $(function() {
    $('.send-comment-btn').click(function() {
      var image_name = $(".video-stream .poster-img").attr("alt"); // Obtener el nombre de la imagen
      var comment_text = $('.chat-footer input[type="text"]').val(); // Obtener el texto del comentario

      // Asegurarse de que el comentario no esté vacío
      if(comment_text.trim() === '') {
        alert('Por favor, escribe un comentario.');
        return;
      }

      $.ajax({
        url: '/add_comment',
        type: 'POST',
        contentType: 'application/json',
        data: JSON.stringify({ image_name: image_name, comment_text: comment_text }),
        success: function(response) {
          if(response.success) {
            console.log('Comentario agregado con éxito');
            // Limpiar el campo de entrada después de enviar el comentario
            $('.chat-footer input[type="text"]').val('');
            // Opcional: Recargar los comentarios aquí o añadir el nuevo comentario al DOM.
          } else {
            console.error('Error agregando comentario: ', response.error);
          }
        },
        error: function(error) {
          console.error('Error agregando comentario', error);
        }
      });
    });
  });
  $(function() {
    $(".video").click(function() {
      // El código existente va aquí...

      // Cargar y mostrar comentarios
      loadAndShowComments($(".video-stream .poster-img").attr("alt"));
    });
  });

  function loadAndShowComments(imageName) {
    $.ajax({
      url: '/comments',
      type: 'GET',
      data: {image_name: imageName},
      success: function(comments) {
        // Limpiar los comentarios antiguos
        $(".message-container").empty();
        // Agregar cada comentario al contenedor de comentarios
        $.each(comments, function(i, comment) {
          $(".message-container").append(
            `<div class="message anim" style="--delay: .1s">
              <div class="author-img__wrapper video-author video-p">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check">
                  <path d="M20 6L9 17l-5-5" />
                </svg>
                <!-- Imagen de perfil del usuario que comentó -->
                <img class="author-img" src="${comment.user_profile_picture}" alt="Foto de perfil de ${comment.username}" />
              </div>
              <div class="msg-wrapper">
                <!-- Nombre del usuario -->
                <div class="msg__name video-p-name">${comment.username}</div>
                <!-- Texto del comentario -->
                <div class="msg__content video-p-sub">${comment.comment_text}</div>
              </div>
            </div>`
          );
        });
      },
      error: function(error) {
        console.error('Error cargando los comentarios', error);
      }
    });
  }
  });
</script>
</body>
</html>